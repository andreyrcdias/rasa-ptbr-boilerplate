# Rasa Boilerplate
<!-- badges -->
<a href="https://www.gnu.org/licenses/gpl-3.0.pt-br.html"><img src="https://img.shields.io/badge/licence-GPL3-green.svg"/></a>
<a href="https://codeclimate.com/github/lappis-unb/rasa-ptbr-boilerplate/maintainability"><img src="https://api.codeclimate.com/v1/badges/8d18e7614e9eef843500/maintainability" /></a>
![badge_build](https://github.com/lappis-unb/rasa-ptbr-boilerplate/workflows/build_bot/badge.svg)


_For PT BR version: [README](README.md)_


The boilerplate was born as a generic abstraction of the [Tais](http://github.com/lappis-unb/tais) project. Today, its goal is to make it easier to create a [Rasa](http://rasa.com/) chatbot. With the evolution of the framework, the current focus of the boilerplate is a living code documentation.

Here you can find a chatbot entirely in Brazilian Portuguese that will assist you with dialogue examples, code, and the use of Rasa functionalities.


## Architecture

The [architecture](https://drive.google.com/file/d/1xUojfFGrYubSfmd3tL77XzgZzD6cR-XH/view?usp=sharing) of the boilerplate can be divided into 2 main parts:

* **Create**

Process that transforms `.yml` configuration files into a `trained model` that contains the intelligence of the chatbot.

![arquitetura_boilerplate-v3-criar](https://github.com/lappis-unb/rasa-ptbr-boilerplate/wiki/images/arquitetura_boilerplate-v3-criar.png)


* **Provide**

The user interacts with the Boilerplate via Telegram, which sends messages to Rasa NLU through connectors, where it identifies the *intent*, and responds through Rasa Core, according to the *stories* and *actions*.

The conversation *models* used were generated by the *trainer* module and then transferred to the bot, these models can be versioned and evolved across bots.

![arquitetura_boilerplate-v3-prover](https://github.com/lappis-unb/rasa-ptbr-boilerplate/wiki/images/arquitetura_boilerplate-v3-criar.png)


## Tutorial

First, clone the repository to your local machine using the command:

```sh
git clone https://github.com/lappis-unb/rasa-ptbr-boilerplate.git
```

To get your Rasa chatbot up and running, make sure you are inside the project folder and then run the following command in the terminal:

```sh
make init
```

This command will build the necessary infrastructure (spin up containers with dependencies, train the chatbot, and start the chat in shell mode) to enable interaction with the chatbot.

Once everything is installed, you will see the following message and can start interacting with the bot:

```sh
Bot loaded. Type a message and press enter (use '/stop' to exit):
Your input ->
```

To close the interaction with the bot, just type `ctrl+c`.


### Commands

* The training command is used to create the necessary models for the bot's conversation. To train your chatbot, run the command:

```sh
make train
```

* To run the bot in the terminal, execute:

```sh
make shell
```

### Telegram Configuration

After following the [tutorial](/docs/setup_telegram.md) to export all necessary environment variables, it is possible to run the bot on Telegram correctly.

**Before proceeding. Important:** Environment variables are necessary for the bot to function correctly, so do not forget to export them.

Then run the bot on Telegram:

```sh
make telegram
```

### Analytics

For viewing the interaction data between the user and the chatbot, we use a part of the Elastic Stack, composed of ElasticSearch and Kibana. Therefore, we use a broker to manage messages. This allows us to add messages to ElasticSearch regardless of the type of messenger we are using.

* For a **quick setup**, run the following command:

```sh
make build-analytics
```

Wait until the *ElasticSearch* services are ready, and run the command below to configure the indexes:

```sh
make config-elastic
``` 

Wait until the *Kibana* services are ready, and run the command below to configure the *dashboards*:

```sh
make config-kibana
``` 

The above command only needs to be executed once and it will leave the entire `analytics` infrastructure ready for use.

Access **kibana** at the url `locahost:5601`

If you want to understand the process of configuring the *analytics* *stack*, see the [complete explanation of analytics](docs/setup_analytics.md).

### Adding custom training components

Rasa allows you to add custom modules to your processing pipeline, learn more [HERE](https://blog.rasa.com/enhancing-rasa-nlu-with-custom-components/).

There is an example of a custom component here that implements Sentiment Analysis.

To use it, simply introduce the `components.sentiment_analyzer.SentimentAnalyzer` component to the `bot/config.yml` file. As in the example:

```yaml
language : "pt"

pipeline:
  - name: WhitespaceTokenizer
  - name: "components.sentiment_analyzer.SentimentAnalyzer"                                                                                        - name: RegexFeaturizer
```

Then, as in the example in the `bot/components/labels.yml` file, add phrases that correspond to a label (rating or sentiment).

Finally, just train the bot again, and the information will be stored in the `sentiment` entity if the component identifies a value for that entity.


## Notebooks - Data Analysis

### Setup

Start the notebooks `container`


```sh
make notebooks
```

Access the notebook at `localhost:8888`

## Documentation

The project documentation can be run locally using [GitBook](https://www.gitbook.com/).
To install GitBook via npm, you need to have [Node.js and npm](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm) installed on your computer.

* Install [GitBook](https://til.secretgeek.net/gitbook/use_gitbook_locally.html):


```sh
npm install -g gitbook gitbook-cli
```

* Once installed, in the project root folder, run:

```sh
gitbook build .
```

* And to run locally run:

```sh
gitbook serve .
```

* Access:

```
http://localhost:4000/
```

**Contribution**: To contribute to the project documentation, read [how to contribute to the documentation](docs/Tutorials/tutorial-how-to-contribute-to-documentation.md)


# How to Get Help

Part of the technical documentation of the Tais framework is available on the
[repository's wiki](https://github.com/lappis-unb/tais/wiki). If you don't find your answer, open an issue with the `question` tag and we will try to respond as quickly as possible.

If you have questions regarding Rasa, check out the [Telegram Rasa Stack Brasil group](https://t.me/RasaBrasil), we are there to help too.

Find more contact information on our website: https://lappis.rocks.

# License

The entire boilerplate framework is developed under license
[GPL3](https://github.com/lappis-unb/rasa-ptbr-boilerplate/blob/master/LICENSE)

See the list of license dependencies [here](https://libraries.io/github/lappis-unb/rasa-ptbr-boilerplate)
